process Demo =  {
    
    source = PoolSource 
    { 
	# replace 'myfile.root' with the source file you want to use
	untracked vstring fileNames = {
	'/store/relval/2008/4/17/RelVal-RelValMinBias-1208465820/0000/1C7E34D3-E00C-DD11-8035-000423D6CA6E.root'  	

	}
    }
   
    untracked PSet maxEvents = { untracked int32 input = -1}
  
    include "FWCore/MessageLogger/data/MessageLogger.cfi"
    replace MessageLogger.cerr.FwkReport.reportEvery = 10
    replace MessageLogger.cerr.threshold = "INFO"
    replace MessageLogger.debugModules = {"TrackerOfflineValidation"}
    
    include "RecoTracker/TrackProducer/data/RefitterWithMaterial.cff"
    replace TrackRefitter.src = "generalTracks"
    //replace TrackRefitter.useHitsSplitting = true
    replace TrackRefitter.TrajectoryInEvent = true
    # needed for refit of hits:
    # usually without refit: 

    replace TrackRefitter.TTRHBuilder = "WithoutRefit"# TransientTrackingRecHitBuilder: no refit of hits...
    include "RecoTracker/TransientTrackingRecHit/data/TransientTrackingRecHitBuilderWithoutRefit.cfi"
    # ... but matching for strip stereo should be redone: 
    replace ttrhbwor.Matcher = "StandardMatcher"
    
    # Database configuration
    include "CondCore/DBCommon/data/CondDBCommon.cfi"
    include "CondCore/DBCommon/data/CondDBSetup.cfi"

    include "Configuration/StandardSequences/data/FakeConditions.cff"

    # Misalignment scenario
    //include "Alignment/TrackerAlignment/data/10pbScenario.cff"
    //es_prefer MisalignedTracker = MisalignedTrackerESProducer { }
    
    include "Alignment/TrackerAlignment/data/Scenarios.cff"
    es_module MisalignedTracker = MisalignedTrackerESProducer
    {

        //<top-level parameters>
        using MisalignmentScenarioSettings

        PSet TIBs  = {
            string distribution = 'fixed'
            PSet TIBStrings = { double dXlocal = 0.0 }
            PSet TIBLayer1 = {
		bool setError = true
		double scaleError = 1000.
                PSet TIBStrings = { double dXlocal = 0.15 }
            }
            PSet Dets = { string distribution = 'gaussian'
                double dXlocal = 0.0005 double dYlocal = 0.0005 double dZlocal = 0.0005
                double phiXlocal = 0.000022  double phiYlocal = 0.000022  double phiZlocal = 0.000022 }
        }

    }
    


    es_prefer MisalignedTracker = MisalignedTrackerESProducer { }

    
    # Apply (mis)alignment
    replace TrackerDigiGeometryESModule.applyAlignment = false


    include "Alignment/OfflineValidation/data/TrackerOfflineValidation.cfi"
    replace TrackerOfflineValidation.Tracks = "TrackRefitter"
    replace TrackerOfflineValidation.trajectoryInput = "TrackRefitter"
    replace TrackerOfflineValidation.TH1ResModules = { int32 Nbinx =  150  double xmin = -1.5 double xmax =  1.5 }

    service  = TFileService {
    	string fileName = "AlignmentValidation_custom.root"
     }

    path p = { TrackRefitter , TrackerOfflineValidation } 
    
}
