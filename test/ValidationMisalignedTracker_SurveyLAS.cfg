process VALIDATIONMISALIGNEDTRACKER = {

    include "FWCore/MessageService/data/MessageLogger.cfi"
    #service = MessageLogger
    #{
    #untracked vstring destinations = {"cout"}
    #	untracked vstring categories    = { "TrackAssociator","TrackValidator" }
    #	#untracked vstring categories    = { "TrackValidator" }
    #	untracked vstring debugModules = {"multiTrackValidator"}
    #untracked PSet cout            = {
    #untracked string threshold = "DEBUG"
    #	    #untracked PSet default   = { untracked int32 limit = 10000000  }
    #	    #untracked PSet FwkJob    = { untracked int32 limit = 0 }
    #	    #untracked PSet DDLParser = { untracked int32 limit = 0 }
    #untracked PSet default   = { untracked int32 limit = 0  }
    #	    untracked PSet INFO   = { untracked int32 limit = 0  }
    #	    untracked PSet DEBUG  = { untracked int32 limit = 0  }
    #	    untracked PSet TrackAssociator = { untracked int32 limit = 10000000 }
    #	    untracked PSet TrackValidator = { untracked int32 limit = 10000000 }
    #}
    #}


    include "Configuration/ReleaseValidation/data/Services.cff"
    include "Configuration/StandardSequences/data/MixingNoPileUp.cff"
    include "Configuration/StandardSequences/data/VtxSmearedGauss.cff"
    include "Configuration/StandardSequences/data/Digi.cff"
    include "Configuration/StandardSequences/data/FakeConditions.cff"
    include "Configuration/StandardSequences/data/Reconstruction.cff"

    ### to misalign the MUONS ###
    # replace DTGeometryESModule.applyAlignment = true
    # replace CSCGeometryESModule.applyAlignment = true


    ### to misalign the TRACKER ###
#    replace TrackerDigiGeometryESModule.applyAlignment = true

    ### Reading misalignments from DB ###
#    include "CondCore/DBCommon/data/CondDBCommon.cfi"
#    replace CondDBCommon.connect = "frontier://cms_conditions_data/CMS_COND_ALIGNMENT"
#    es_source misalignment = PoolDBESSource {
#        using CondDBCommon
#        VPSet toGet = {
#            { string record = "DTAlignmentRcd"           string tag = "DT10InversepbScenario150" },
#            { string record = "DTAlignmentErrorRcd"      string tag = "DT10InversepbScenarioErrors150" },
#            { string record = "CSCAlignmentRcd"          string tag = "CSC10InversepbScenario150" },
#            { string record = "CSCAlignmentErrorRcd"     string tag = "CSC10InversepbScenarioErrors150" },
#            { string record = "TrackerAlignmentRcd"      string tag = "TrackerIdealGeometry150" },
#            { string record = "TrackerAlignmentErrorRcd" string tag = "TrackerIdealGeometryErrors150" }
#            { string record = "TrackerAlignmentRcd"      string tag = "Tracker10pbScenario150" },
#            { string record = "TrackerAlignmentErrorRcd" string tag = "Tracker10pbScenarioErrors150" }
#            { string record = "TrackerAlignmentRcd"      string tag = "Tracker100pbScenario150" },
#            { string record = "TrackerAlignmentErrorRcd" string tag = "Tracker100pbScenarioErrors150" }
#            { string record = "TrackerAlignmentRcd"      string tag = "Tracker1000pbScenario150" },
#            { string record = "TrackerAlignmentErrorRcd" string tag = "Tracker1000pbScenarioErrors150" }
#            { string record = "TrackerAlignmentRcd"      string tag = "TrackerSurveyLASCosmicsScenario160" },
#            { string record = "TrackerAlignmentErrorRcd" string tag = "TrackerSurveyLASCosmicsScenarioErrors160" }
#        }
#        bool loadAll = true
#        untracked bool siteLocalConfig = true
#    }
#    es_prefer misalignment = PoolDBESSource {}
  

    untracked PSet maxEvents = {untracked int32 input = -1}
    source = PoolSource { 
	untracked vstring fileNames = {
'file:/home1/prodagent/16C395ED-CE6E-DC11-B6A8-000423D99658.root',
'file:/home1/prodagent/1A75CFF7-CA6E-DC11-81EE-000423D6A6D8.root',
'file:/home1/prodagent/2CB49EEE-CC6E-DC11-B680-000423D990CC.root',
'file:/home1/prodagent/3C159FF5-CC6E-DC11-926E-001617C3B728.root',
'file:/home1/prodagent/3EE4C4F1-CA6E-DC11-8C1D-000423D94670.root',
'file:/home1/prodagent/4ADE4F02-CF6E-DC11-AEC1-001617DBD5B2.root',
'file:/home1/prodagent/524BE5E0-CC6E-DC11-9E81-001617DBD316.root',
'file:/home1/prodagent/563E6D9A-0C6F-DC11-9E3B-000423D94A04.root',
'file:/home1/prodagent/62FC9EFF-CE6E-DC11-B1CB-000E0C3F4776.root',
'file:/home1/prodagent/70E03DFF-CA6E-DC11-832D-000423D9462C.root',
'file:/home1/prodagent/CC01CFE4-CC6E-DC11-995A-000423D98520.root',
'file:/home1/prodagent/E87767E9-CA6E-DC11-BA45-001617DBCF44.root',
'file:/home1/prodagent/F6C686E3-CC6E-DC11-8BA5-000423DD2F34.root'
	}
    }

    module evtInfo = AsciiOutputModule {}

    #Geometry
    #
#    include "Geometry/TrackerSimData/data/trackerSimGeometryXML.cfi"
#    es_module = TrackerGeometricDetESModule {}


    # Include MagneticField Record
#    include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"
#    es_module = TrackerDigiGeometryESModule {}

    include "Alignment/TrackerAlignment/data/SurveyLASOnlyScenario.cff"
    // Misalignment scenario producer
    // replace MisalignmentScenarioSettings.setError = false
    // replace MisalignmentScenarioSettings.seed = 1325467
    es_prefer MisalignedTracker = MisalignedTrackerESProducer {}  


    # Track Associators
    include "SimTracker/TrackAssociation/data/TrackAssociatorByChi2.cfi"
    include "SimTracker/TrackAssociation/data/TrackAssociatorByHits.cfi"
    

    # Filters
    include "Validation/RecoTrack/data/cuts.cff"
    # include "Validation/RecoMuon/data/cuts.cff"

    # replace cutsCKF.src=TrackRefitter
    # replace cutsRS.src=TrackRefitter
    # replace cutsCKF.src=muons
    # replace cutsGLB.src=muons

    # Track Validator    

    module misalignmentvalidation = ValidationMisalignedTracker {
     untracked bool selection_eff   = true
     untracked bool selection_fake   = true
     untracked bool ZmassSelection   = false
     VInputTag label = {cutsCKF}
     # VInputTag label = {ctfWithMaterialTracks}
     InputTag label_tp_effic = cutsTPEffic
     InputTag label_tp_fake = cutsTPFake
     # InputTag label_tp_effic = trackingParticles
     # InputTag label_tp_fake = trackingParticles
     vstring associators = {"TrackAssociatorByHits"}
     untracked string rootfile   = "ValidationMisalignedTracker_ttbar_SurveyLAS.root"
    }

    include "SimGeneral/TrackingAnalysis/data/trackingParticles.cfi"

    # path p = {reconstruction,cutsCKF,cutsTPEffic,cutsTPFake,misalignmentvalidation}
    
    endpath ep = {
	evtInfo,mix,doAllDigi,trackingParticles,reconstruction,cutsCKF,cutsTPEffic,cutsTPFake,misalignmentvalidation
    }
}
